import{a as d,b as u}from"./chunk-WGDVPG6T.js";import{e as i,g as a,l as c,n,o as b,r as o,u as p,ua as v}from"./chunk-DT3J2NFD.js";var l=class r{recipesSubject;favoriteSubject;constructor(){let e=this.getDataFromLocalStorage("recipes"),t=this.getDataFromLocalStorage("favorites");this.recipesSubject=new i(e),this.favoriteSubject=new i(t),window.addEventListener("storage",()=>this.onLocalStorageChange())}getDataFromLocalStorage(e){let t=localStorage.getItem(e);return t?JSON.parse(t):[]}onLocalStorageChange(){let e=this.getDataFromLocalStorage("recipes");this.recipesSubject.next(e);let t=this.getDataFromLocalStorage("favorites");console.log("updatedFavorites",t),this.favoriteSubject.next(t)}getRecipeObservable(){return this.recipesSubject.asObservable()}getFavoriteObservable(){return this.favoriteSubject.asObservable()}updateData(e,t){localStorage.setItem(t,JSON.stringify(e)),t==="recipes"?this.recipesSubject.next(e):t==="favorites"&&this.favoriteSubject.next(e)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var f=class r{constructor(e,t,s){this.http=e;this.errorNotificationService=t;this.localStorageService=s}URL=d.api;recipesKey="recipes";favoritesKey="favorites";selectedRecipeSubject=new i(null);selectedRecipe$=this.selectedRecipeSubject.asObservable();openFormSubject=new i(!1);openForm$=this.openFormSubject.asObservable();openForm(e){this.selectedRecipeSubject.next(e),this.openFormSubject.next(!0)}closeForm(){this.selectedRecipeSubject.next(null),this.openFormSubject.next(!1)}populateRecipes$(){return this.http.get(`${this.URL}/recipes/get`).pipe(b(e=>{this.localStorageService.updateData(e,this.recipesKey)}),c(e=>{throw this.errorNotificationService.showError("Error al poblar recetas: "+e.message),e}))}addRecipe$(e){return this.http.post(`${this.URL}/recipes/add`,e).pipe(n(()=>this.populateRecipes$()),c(t=>(this.errorNotificationService.showError("Error al a\xF1adir receta: "+t.message),a({}))))}getRecipeById$(e){let t=this.localStorageService.getDataFromLocalStorage("recipes").find(s=>s._id===e);if(t)return a(t);throw new Error("No se encontr\xF3 la receta")}updateRecipe$(e,t){return this.http.put(`${this.URL}/recipes/edit/${e}`,t).pipe(n(()=>this.populateRecipes$()),c(s=>(this.errorNotificationService.showError("Error al actualizar receta: "+s.message),a({}))))}removeRecipe$(e){return this.http.delete(`${this.URL}/recipes/delete/${e}`).pipe(n(()=>this.populateRecipes$()),c(t=>(this.errorNotificationService.showError("Error al eliminar receta: "+t.message),a({}))))}static \u0275fac=function(t){return new(t||r)(p(v),p(u),p(l))};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};var S=class r{showModalSubject=new i(!1);warningMessageSubject=new i("");confirmActionSubject=new i(()=>{});get showModal$(){return this.showModalSubject.asObservable()}get warningMessage$(){return this.warningMessageSubject.asObservable()}get confirmAction$(){return this.confirmActionSubject.asObservable()}openModal(e,t){this.warningMessageSubject.next(e),this.confirmActionSubject.next(t),this.showModalSubject.next(!0)}closeModal(){this.showModalSubject.next(!1)}static \u0275fac=function(t){return new(t||r)};static \u0275prov=o({token:r,factory:r.\u0275fac,providedIn:"root"})};export{l as a,f as b,S as c};
